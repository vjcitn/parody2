<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>parody: parametric and resistant outlier dytection • parody</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="parody: parametric and resistant outlier dytection">
<meta property="og:description" content="parody">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">parody</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.49.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/parody.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="parody_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>parody: parametric and resistant outlier dytection</h1>
                        <h4 class="author">Vincent J. Carey, stvjc at channing.harvard.edu</h4>
            
            <h4 class="date">January 17, 2021</h4>
      
      
      <div class="hidden name"><code>parody.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Outliers are data points that seem anomalous. Precise quantitative measurement of anomalousness is easiest when a parametric probability model is adopted. Significant statistical and computational research has been devoted to devising and rationalizing criteria for outlyingness that do not require adoption of a parametric probability model. This package provides interfaces to various methods presented in the literature of statistical methods for measuring outlyingness in univariate and multivariate samples. It is offered as a resource through bioconductor.org because formal testing for outliers is a common concern of genome scale data analysis, in many different contexts.</p>
</div>
<div id="univariate-samples" class="section level1">
<h1 class="hasAnchor">
<a href="#univariate-samples" class="anchor"></a>Univariate samples</h1>
<p>Davies and Gather (1992) present a detailed study of criteria for outlyingness in univariate samples. Inlier boundaries are defined, with form <span class="math inline">\((\hat{m}-c(n)\hat{s}, \hat{m} + c(n) \hat{s})\)</span>, where <span class="math inline">\(\hat{m}\)</span> is a location parameter estimate, <span class="math inline">\(\hat{s}\)</span> is a scale parameter estimate, and <span class="math inline">\(c(n)\)</span> are multipliers depending on sample size. Candidates for <span class="math inline">\(m\)</span> are trimmed mean, median, midpoint of shorth; candidates for <span class="math inline">\(s\)</span> include trimmed standard deviation, median absolute deviation (MAD), length of shorth. The familiar boxplot outlier labeling rules do not fall immediately into this framework, as the left and right inlier boundaries may not be equidistant from the location parameter value.</p>
<p>This package provides functions implementing components of the various labeling rules; users may mix components to define their own procedures.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">parody</span><span class="op">)</span></code></pre></div>
<p>We define a dataset presented in Rosner (1983). The data concern tapping frequencies achieved by children with various exposures to lead.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lead</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">83</span>, <span class="fl">70</span>, <span class="fl">62</span>, <span class="fl">55</span>, <span class="fl">56</span>, <span class="fl">57</span>, <span class="fl">57</span>, <span class="fl">58</span>, <span class="fl">59</span>, <span class="fl">50</span>, <span class="fl">51</span>, 
        <span class="fl">52</span>, <span class="fl">52</span>, <span class="fl">52</span>, <span class="fl">54</span>, <span class="fl">54</span>, <span class="fl">45</span>, <span class="fl">46</span>, <span class="fl">48</span>,
        <span class="fl">48</span>, <span class="fl">49</span>, <span class="fl">40</span>, <span class="fl">40</span>, <span class="fl">41</span>, <span class="fl">42</span>, <span class="fl">42</span>, <span class="fl">44</span>, 
        <span class="fl">44</span>, <span class="fl">35</span>, <span class="fl">37</span>, <span class="fl">38</span>, <span class="fl">38</span>, <span class="fl">34</span>, <span class="fl">13</span>, <span class="fl">14</span><span class="op">)</span></code></pre></div>
<p>We can use a boxplot to visualize the distribution. This includes an outlier labeling criterion, and the dots beyond the whiskers are declared to be outlying.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">lead</span><span class="op">)</span></code></pre></div>
<p><img src="parody_files/figure-html/dobox1-1.png" width="700"></p>
<p>The first formal assessment uses the familiar boxplot rules. For this, we need to supply a scaling function as described in the manual page.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calout.detect.html">calout.detect</a></span><span class="op">(</span><span class="va">lead</span>,alpha<span class="op">=</span><span class="fl">.05</span>,method<span class="op">=</span><span class="st">"boxplot"</span>, scaling<span class="op">=</span>
<span class="kw">function</span><span class="op">(</span><span class="va">n</span>,<span class="va">alpha</span><span class="op">)</span><span class="fl">1.5</span><span class="op">)</span></code></pre></div>
<pre><code>## $ind
## [1] 34 35  1
## 
## $val
## [1] 13 14 83
## 
## $outlier.region
## [1] 18.16667 76.83333</code></pre>
<p>We can see that this agrees with the R visualization.</p>
<p>Theoretical work on the calibration of the boxplot rule is deployed when <code>ftype</code> is set to <code>"ideal"</code>. See the manual page for references.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calout.detect.html">calout.detect</a></span><span class="op">(</span><span class="va">lead</span>,alpha<span class="op">=</span><span class="fl">.05</span>,method<span class="op">=</span><span class="st">"boxplot"</span>,ftype<span class="op">=</span><span class="st">"ideal"</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning in tukeyorinds(x = x, alpha = alpha, g = g): no data values in outlier
## region</code></pre>
<pre><code>## $ind
## [1] NA
## 
## $val
## [1] NA
## 
## $outlier.region
## [1]  7.808079 87.191921</code></pre>
<p>Another procedure that does not fit in the Davies and Gather framework is the generalized extreme studentized deviate procedure due to B Rosner. In this procedure, we prespecify the number of possibly outlying points <span class="math inline">\(k\)</span> (which may be any number less than half the sample size), and the <span class="math inline">\(k\)</span> most extreme studentized deviates are obtained and recorded from the highest to lowest value. Then repeated `outward testing’ is conducted using analytic critical values that bound the rate of false outlier labeling for the entire testing procedure, whether or not outliers are present.</p>
<p>Here we apply Rosner’s procedure:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calout.detect.html">calout.detect</a></span><span class="op">(</span><span class="va">lead</span>,alpha<span class="op">=</span><span class="fl">.05</span>,method<span class="op">=</span><span class="st">"GESD"</span>,k<span class="op">=</span><span class="fl">5</span><span class="op">)</span></code></pre></div>
<pre><code>## $ind
## [1]  1 34 35
## 
## $val
## [1] 83 13 14</code></pre>
<p>It gives results that agree with the standard boxplot.</p>
<p>Davies and Gather characterize a rule based on median and MAD using scaling functions <span class="math inline">\(c(n)\)</span> that they associate with Hampel. This procedure uses the scaling function defined in their expression (3).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calout.detect.html">calout.detect</a></span><span class="op">(</span><span class="va">lead</span>,alpha<span class="op">=</span><span class="fl">.05</span>,method<span class="op">=</span><span class="st">"medmad"</span>,scaling<span class="op">=</span><span class="va">hamp.scale.3</span><span class="op">)</span></code></pre></div>
<pre><code>## $ind
## [1] 34 35  1
## 
## $val
## [1] 13 14 83
## 
## $outlier.region
## [1] 14.92932 81.07068</code></pre>
<p>Finally we use the shorth-based detector.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calout.detect.html">calout.detect</a></span><span class="op">(</span><span class="va">lead</span>,alpha<span class="op">=</span><span class="fl">.05</span>,method<span class="op">=</span><span class="st">"shorth"</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning in rououtinds(x = x, alpha = alpha, g = g): no data values in outlier
## region</code></pre>
<pre><code>## $ind
## [1] NA
## 
## $val
## [1] NA
## 
## $outlier.region
## [1]  6.215225 94.784775</code></pre>
</div>
<div id="multivariate-samples" class="section level1">
<h1 class="hasAnchor">
<a href="#multivariate-samples" class="anchor"></a>Multivariate samples</h1>
<p>A sample dataset called <code>tcost</code> is supplied with the package. Before visualizing, we compute a default multivariate outlier criterion, due to Caroni and Prescott, that generalizes Rosner’s GESD:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">tcost</span><span class="op">)</span>
<span class="va">ostr</span> <span class="op">=</span> <span class="fu"><a href="../reference/mv.calout.detect.html">mv.calout.detect</a></span><span class="op">(</span><span class="va">tcost</span><span class="op">)</span>
<span class="va">ostr</span></code></pre></div>
<pre><code>## $inds
## [1] 21  9
## 
## $vals
##     fuel repair capital
## 21 26.16  17.44   16.89
## 9  29.11  15.09    3.28
## 
## $k
## [1] 17
## 
## $alpha
## [1] 0.05</code></pre>
<p>We see that indices 9 and 21 are flagged. Let’s create a pairs plot with coloring.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">thecol</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">tcost</span><span class="op">)</span><span class="op">)</span>
<span class="va">thecol</span><span class="op">[</span><span class="va">ostr</span><span class="op">$</span><span class="va">ind</span><span class="op">]</span> <span class="op">=</span> <span class="st">"red"</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">tcost</span>, col<span class="op">=</span><span class="va">thecol</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span></code></pre></div>
<p><img src="parody_files/figure-html/doparis-1.png" width="700"></p>
<p>Another display of interest employs principal components:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">tcost</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/biplot.html">biplot</a></span><span class="op">(</span><span class="va">pc</span><span class="op">)</span></code></pre></div>
<p><img src="parody_files/figure-html/dobipi-1.png" width="700"></p>
<p>To get a sense of the robustness (or lack thereof) of the biplot, let us replot after removing the datapoints that were marked as outliers by the Caroni and Prescott procedure.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ftcost</span> <span class="op">=</span> <span class="va">tcost</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">9</span>,<span class="fl">21</span><span class="op">)</span>,<span class="op">]</span>
<span class="va">fpc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">ftcost</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/biplot.html">biplot</a></span><span class="op">(</span><span class="va">fpc</span><span class="op">)</span></code></pre></div>
<p><img src="parody_files/figure-html/mvmv-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Vince Carey.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
